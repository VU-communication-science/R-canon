{
  "hash": "b40dc58f18b86ae7e6ebb11be2816d91",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Linear regression\nsubtitle: \"Predicting one variable from another\"\nformat:\n  html:\n    df-print: kable\n---\n\n\n\n\n# What is regression analysis?\n\nRegression analysis is a statistical technique for *predicting* a `dependent variable` based on one or more `independent variables`.\nWe use *predict* in a statistical sense, meaning that we are estimating how well we can guess the dependent variable given knowledge of the independent variable(s).\nThe reason we want to do this is usually not to make actual predictions, but to understand the relationship between the variables.\nIf one variable can predict another, it tells us something about how they might be related.\n\nLet's first look a how this prediction works for a single independent variable.\nThis is also called **simple linear regression**.\nWe have a dependent variable `Y` and an independent variable `X`, and we want to predict `Y` based on `X`.\nThe goal is to find a mathematical formula that best describes their relationship.\nYou can visually think of this as a scatterplot, where we draw a `regression line`  such that the distance between the line and the data points is as small as possible.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](linear-regression_files/figure-html/unnamed-chunk-1-1.png){width=100%}\n:::\n:::\n\n\n\n\nThis model can be described by a classic formula, called the **regression equation**.\nWe've coloured the different parts of the equation according to the colours used in the visualization. \n\n\n$$ \\Large  \\color{Green} Y_i = \\color{Blue} b_0 + b_1 X_i + \\color{Red} \\epsilon_i $$\n\n* $\\color{Green} Y_i$ represents the real values of the dependent variable ($Y_1, Y_2, ... Y_n$) that we want to predict.\n* $\\color{Blue} b_0 + b_1 X_i$ represents our prediction of y. It has two coefficients: \n  * $\\color{Blue} b_0$ is the **intercept**. This is the value of Y when X is zero.\n  * $\\color{Blue} b_1$ is the **slope**. This tells us how much Y changes for every unit increase in X.\n* $\\color{Red} \\epsilon_i$ represents the **error**. This is the distance between the <span style=\"color:blue;\">predicted</span> and the <span style=\"color:green\">real</span> value of Y.\n\nFor example, at $X = 10$, the blue line predicting Y passes through the point $Y = 10.45$.\nHowever, the real value of Y at this point is 8.66. \nSo the error $\\epsilon_i$ at this point is $8.66 - 10.45 = -1.79$.\n\nThe point of regression analysis is to find the values of $b_0$ (intercept) and $b_1$ (slope) that minimize the error.\nMore specifically, it minimizes the sum of the squared errors (SSE), which is why this method is called **least squares regression**.\n\n$$  SSE = \\large \\sum_{i=1}^{n} {\\color{red} \\epsilon_i^2} $$\n\nTry it yourself! \nChange the values of the intercept and slope in the interactive widget below, and see how the regression line changes.\nThe goal is to get the lowest possible SSE, which means that the line is as close as possible to the data points.\n\n\n\n\n\n```{ojs}\n//| echo: false\nviewof intercept = Inputs.range(\n  [-8, 6], \n  {value: 3, step: 0.001, label: \"Intercept\"}\n)\nviewof slope = Inputs.range(\n  [0.5,1.8], \n  {value: 0.5, step: 0.001, label: \"Slope\"}\n)\n```\n\n```{ojs}\n//| echo: false\nx_line = Array.from({ length: 100 }, (_, i) => i-5);\ny_line = x_line.map(x => slope * x + intercept);\nmutable error = 0\n\nupdate_error = {\n  let sse = 0\n  x.forEach((d, i) => {\n    sse += Math.pow(y[i] - (slope * x[i] + intercept), 2)\n  })\n  mutable error = Number(sse.toFixed(2))\n}\n\n// Now, plot the regression line\nPlot.plot({\n  marks: [\n    Plot.lineY(y_line, {x: x_line, stroke: \"blue\"}),\n    Plot.dot(x, {x: x, y: y, fill: \"darkgreen\"}),\n    Plot.text([{intercept,slope}], {x: 10, y: 3, text: d => `prediction = ${d.intercept.toFixed(2)} + ${d.slope.toFixed(2)} * X`, fill: \"black\", fontSize: 16, fill: \"blue\", textAnchor: \"start\"}),\n    Plot.text([error], {x: 10, y: 0, text: d => `SSE = ${d}`, fill: \"black\", fontSize: 16, fill: \"red\", textAnchor: \"start\"})\n  ],\n  x: {\n    label: \"X\",\n    domain: [-5, 20]\n  },\n  y: {\n    label: \"Y\",\n    domain: [-5,22]\n  },\n  height: 300\n})\n\n```\n\n\n\n\n::: {.callout-tip title=\"Spoiler\" collapse=\"true\"}\n\nThe optimal values for the intercept and slope are $b_0 = 0.930$ and $b_1 = 0.952$.\nThis should give you an SSE of $160.24$.\n\n\n:::\n\n## What can we do with it?\n\nThe primary goal of regression analysis is to understand the relationship between variables.\nIt allows us to test hypotheses of the sort:\n\n* Older people have more trust in journalists\n* People on the political left have more trust in journalists than people on the political right\n\nYou might be wondering: can't we already do the first one with a correlation test, and the second one with a t-test?\nThe answer is yes, and one benefit of regression analysis is that it can do both these things in the same model.\nBut **more importantly**, regression analysis can test both of these things **at the same time**, and account for the fact that age and political orientation are related to each other!\nIf we know that younger people are more likely to be on the political left, then in order to test the effect of age on trust, we need to somehow account for political orientation.\n\nIn this tutorial we will show you how to use regression analysis to predict a person's `trust in journalists` based on `age` and `political orientation`.\nThe model we will be working towards looks like this:\n\n$$ \\large  \\color{Green} Y_i = \\color{Blue} b_0 + b_1 X_{age} + b_2 X_{political\\_left} + b_3 X_{political\\_right} + \\color{Red} \\epsilon_i $$\n\nDon't worry if this doesn't make sense yet! We'll take it step by step.\n\n* We'll first show you how to do a simple linear regression, where we predict `trust` based on `age`.\n* Then we'll show you how to include a categorical variable in the model, by predicting `trust` based on `political orientation`.\n* Finally, we'll show you how to include both `age` and `political orientation` in the model at the same time.\n\n<!-- Regression analysis allows you to find a mathematical formula that predicts trust based on a combination of these variables.\nThis can help you understand complex relationships between two or more variables. -->\n\n<!-- We refer to the variable that we want to predict (trust) as the **dependent variable**, and the variables that we use to make the prediction (age) as the **independent variables**. -->\n<!-- In the current tutorial you will first learn about simple linear regression, where we use one independent variable to predict the dependent variable.\nAs you progress, you will learn about [multiple regression](../tests/multiple-regression.qmd), where we use more than one independent variable at once. -->\n\n# How to use it\n\nWe'll be using our standard (simulated) practice data, and a bit of `tidyverse` to load and clean the data.\nWe'll also be using the `sjPlot` package, which can create nice tables and plots of regression models.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(sjPlot)\n\nd <- read_csv(\"https://tinyurl.com/R-practice-data\") |>\n        mutate(age = if_else(age > 100, 2024 - age, age)) |>\n        select(age, political_orientation, trust_t1)\n\nd\n```\n:::\n\n\n\n\nThe **dependent** variable in the regression model has to be numeric.\nFor our examples we'll use the `trust_t1` variable, which measures a person's trust in journalists on a scale from 1 to 10. \nA regression model can have **one or multiple independent** variables, which can be numeric or categorical.\nThis makes regression analysis a very flexible tool that can be used in many different situations.\nIn this example we'll demonstrate this with both a numeric (`age`) and a categorical (`political_orientation`) independent variable.\n\n## Regression with numerical independent variable\n\nLet's start with the example of predicting `trust` in journalists based on `age`.\nFor this we'll be using the `trust_t1`[^1] variable as the dependent variable, and the `age` variable as the independent variable.\nWe can use the `lm()` function to create a linear regression model.\nInside the `lm()` function we specify the formula for the regression, which has the format `dependent ~ independent`. \n\n[^1]: We use the `trust_t1` variable here, because for the current analysis we are not interested in the effect of the experimental group. Since `trust_t1` is measured before the experiment, it is not influenced by the experiment.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- lm(trust_t1 ~ age, data = d) \n```\n:::\n\n\n\n\nThe *standard* way to inspect the results is using the `summary(m)` function.\nThis gives you all the information you need, but not in a very nice and readable format.\nWe will therefore be using the `tab_model()` function from the `sjPlot` package to get a nice (APA ready) table of the results.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab_model(m)\n```\n\n::: {.cell-output-display  html-table-processing=none}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">trust_t1</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.28</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.04&nbsp;&ndash;&nbsp;2.51</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">age</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.03&nbsp;&ndash;&nbsp;0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">595</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.261 / 0.260</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n\n::: {.callout-caution title=\"Backup plan if tab_model doesn't work\" collapse=\"true\"}\n\nThe `tab_model` function by default shows the regression table in your `viewer` pane.\nIf this for some reason doesn't work, you can also use the `use.viewer=F` argument to show the table in your default web browser.\nThis has the additional benefit that you can directly copy-paste the table into most text editors.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab_model(m, use.viewer=F)\n```\n:::\n\n\n\n:::\n\nThe output of the regression analysis gives us values for the two coefficients: the **(intercept)** and the **age** variable.\nWe get the coefficient **estimates**, and also the **p-values** that tell us if these coefficients are statistically significant.\nWith `tab_model` we also get the **confidence interval**. \n\nThe coefficient for `age` tells us how much `trust_t1` changes for every *unit increase* in `age`.\nOur `age` variable is in years, so the coefficient `0.04` tells us that for every year of age, trust in journalists increases on average by 0.04 points.\n\nTo get a better view of what this means in practice, it can be helpful to plot the regression line.\nThe `sjPlot` package has a function `plot_model()` that can do this for us.\nHere we visualize the prediction (`type = \"pred\"`) for the `age` variable (`terms = \"age\"`).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_model(m, type = \"pred\", terms = \"age\")\n```\n\n::: {.cell-output-display}\n![](linear-regression_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\nHere the *regression line* shows the predicted values. \nAt age 20 the predicted trust is around 3.05.\nFor every year of age the predicted trust increases by 0.04 points, so by the time a person is 40 years old, the predicted trust is around 3.85.\nVisualizing effects like this can give readers (and yourself) a better understanding of how strong the effect really is.\n\n\n## Regression with categorical independent variable\n\nThe **independent variable** in a regression model can also be categorical.\nThis allows us to include categorical variables in the model, similar to the t-test and ANOVA.\nLet's see what this looks like when we predict `trust_t1` based on the `political_orientation` variable, which has the values `left`, `right` and `center`.\n\nWe cannot directly use the values \"left\", \"right\" and \"center\" in the regression equation, but we create so-called **dummy variables**.\nA dummy variable is a *binary* variable (i.e., it can only take the values `0` and `1`) that represents whether something is the case or not.\nSo if we want to test whether people that lean to the left have more trust in journalists, we can create a dummy variable that is `1` for people with orientation `left`, and `0` for all other people (i.e., `right` and `center`).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd = mutate(d, political_left = if_else(political_orientation == \"left\", 1, 0))\n\nselect(d, political_orientation, political_left)\n```\n:::\n\n\n\n\nNow we can use this variable in the regression model.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- lm(trust_t1 ~ political_left, data = d)\n\ntab_model(m)\n```\n\n::: {.cell-output-display  html-table-processing=none}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">trust_t1</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.83</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.73&nbsp;&ndash;&nbsp;3.93</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">political left</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.21</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.03&nbsp;&ndash;&nbsp;0.38</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.019</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">600</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.009 / 0.008</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n\nThe interpretation of the results is almost identical to the previous example with the `age` variable.\nThe only thing we need to keep in mind is that the `political_left` variable is binary, so it can only take the values `0` and `1`.\nAccordingly, we don't say that the trust in journalists increases by `0.21` points for every unit increase in `political_left`.\nInstead, we just say that people on the political left (`political_left = 1`) have on average a trust score that is `0.21` points higher than people that are not on the political left (`political_left = 0`).\n\n<!-- Note that in this case we can actually interpret the **intercept**.\nThe intercept is the predicted value of the dependent variable when the independent variable is zero.\nSo in this case, the intercept (`3.83`) is the predicted trust in journalists for people that are NOT `political_left`. -->\n\n### Categories with more than two levels\n\nIn the previous example we created the dummy variable ourselves, but we can also let R do this for us.\nThis is especially convenient if we have more than two categories.\nIn addition, this also has the benefit that `lm` *knows* that the variable is categorical, which enables us (among other things) to visualize the model propertly.\n\nIf an independent variable is of the `character` or `factor` type, R will automatically create dummy variables for us.\n\nWe first need to make sure that our variable is of the `factor` type[^3].\nThe difference between a `character` and a `factor` is that in a `factor` we explicitly tell R what the categories are, and what the *order* of the categories is.\nThe order is important, because the first category will be the **reference category** (more on this later) in the regression model.\nTo transform our `political_orientation` variable to a `factor` we can use the `factor()` function, and provide the `levels` argument to specify the order of the categories.\n\n[^3]: You *can* also use a `character` variable directly, but the `factor` type is more appropriate for categorical variables. It also let's you specify the order of the categories, which is important for regression analysis because it let's you specify the reference category.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- mutate(d, political_orientation = factor(political_orientation, levels=c('center','left','right')))\n```\n:::\n\n\n\n\nNow, when we use the `political_orientation` variable in the regression model, R will automatically create the dummy variables for us.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- lm(trust_t1 ~ political_orientation, data = d)\ntab_model(m)\n```\n\n::: {.cell-output-display  html-table-processing=none}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">trust_t1</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.91</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.77&nbsp;&ndash;&nbsp;4.05</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">political orientation<br>[left]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.07&nbsp;&ndash;&nbsp;0.32</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.220</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">political orientation<br>[right]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.17</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.36&nbsp;&ndash;&nbsp;0.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.100</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">600</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.014 / 0.010</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n\nNotice that there are now two coefficients for the `political_orientation` variable: one for `left` and one for `right`.\nWhy 2, and not 3?\nThis is because when we have a categorical variable with `k` levels, we only need `k-1` coefficients to represent all the levels.\nIf we know that a person is not in the `left` category, and not in the `right` category, then we know that the person must be in the `center` category.\n\n| political_orientation | is_left | is_right |\n|-----------------------|---------|----------|\n| left                  | 1       | 0        |\n| right                 | 0       | 1        |\n| center                | 0       | 0        |\n\nThe `center` category is now the **reference category**.\nThat is, the `center` category is the category that all other categories are compared to.\nSo the `political_orientation [left]` coefficient tells us that `trust` is for people in the `left` category is 0.12 points higher than for people in the `center` category, but this difference is not significant (p = 0.220)\nThe `political_orientation [right]` coefficient tells us that `trust` is for people in the `right` category is 0.17 points lower than for people in the `center` category, but this difference is also not significant (p = 0.100).\n\n::: {.callout-note title=\"Determining what reference category to use\" collapse=\"true\"}\n\nIn the current model we cannot directly compare the `left` and `right` categories, because the `center` category is the reference category.\nThis makes it important to choose a reference category that makes sense for your research question.\nTo determine the reference category, you can change the order of the levels in the `factor()` function.\nThe first level will always be the reference category.\nSo in the following example, the `left` category is the reference category.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd2 <- mutate(d, political_orientation = factor(political_orientation, levels=c('left','center','right')))\n\nlm(trust_t1 ~ political_orientation, data = d2) |>\n    tab_model()\n```\n\n::: {.cell-output-display  html-table-processing=none}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">trust_t1</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">4.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.89&nbsp;&ndash;&nbsp;4.18</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">political orientation<br>[center]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.32&nbsp;&ndash;&nbsp;0.07</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.220</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">political orientation<br>[right]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.29</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.49&nbsp;&ndash;&nbsp;-0.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.004</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">600</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.014 / 0.010</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n:::\n\nWhen we visualize the prediction for a categorical variable, we get a plot that shows the predicted value for each category, with the confidence interval.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_model(m, type = \"pred\", terms = \"political_orientation\")\n```\n\n::: {.cell-output-display}\n![](linear-regression_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n\nHere we see that (in our simulated data) people on the political left have the highest trust in journalists, followed by people in the center, and then people on the political right.\nHowever, based on the model we know that the difference between `left` and `center` is not significant, and neither is the difference between `center` and `right`.\n\n## Regression with multiple independent variables\n\nNow, we can finally get to the most interesting part: using multiple independent variables in the regression model.\nThis is called **multiple regression**, and it allows us to test the effect of multiple variables on the dependent variable at the same time.\nThe formula for using multiple independent variables is: `dependent ~ independent1 + independent2 + ...`.\n\nWe'll be using both the `age` and `political_orientation` variables.\nAs we mentioned earlier, by including both variables in the model we can test the effect of `age` on `trust` while controlling for `political_orientation`, and vice versa.\nTo show you how this works, we'll create two models, and show them side by side by plugging them both into the `tab_model()` function.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(trust_t1 ~ political_orientation, data = d)\nm2 <- lm(trust_t1 ~ political_orientation + age, data = d)\n\ntab_model(m1, m2)\n```\n\n::: {.cell-output-display  html-table-processing=none}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">trust_t1</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">trust_t1</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7\">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.91</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.77&nbsp;&ndash;&nbsp;4.05</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.11</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.87&nbsp;&ndash;&nbsp;2.35</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">political orientation<br>[left]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.07&nbsp;&ndash;&nbsp;0.32</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.220</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.26</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.09&nbsp;&ndash;&nbsp;0.42</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"><strong>0.003</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">political orientation<br>[right]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.17</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.36&nbsp;&ndash;&nbsp;0.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.100</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.42</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.59&nbsp;&ndash;&nbsp;-0.25</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">age</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.04&nbsp;&ndash;&nbsp;0.05</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">600</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">595</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.014 / 0.010</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.330 / 0.327</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n\nIn the first model, we did not see any effect of having a `left` or `right` political orientation compared to the `center` (reference) category.\nBut once we include the `age` variable in the model, both the `left` and `right` categories show do show a significant effect on `trust`!\n\nThe reason for this is that the `age` variable is related to both the `political_orientation` variable and the `trust` variable.[^4]\nYounger people have less trust in journalists, but are also more likely to be on the political left.\nTherefore, if we do not control for `age`, the positive effect of being on the political left is suppressed by the negative effect of being younger.\n\n[^4]: Remember that this is a simulated dataset, so in this case we know the true relationships between the variables. \nBut these types of complex relationships are very common in real data.\n\nIf this sounds confusing, don't worry, because you're in good company!\nThinking about how the effect of independent variables *on* the dependent variable depends on the relation *between* the independent variables can make your head spin.\nBut for better or worse, this is how the world works, and this is why we need sophisticated statistical tools to help us understand it.\n\n\n\n\n<!-- ```{r}\nplot_model(m2, type = \"pred\", terms = c(\"age\", \"political_orientation\"))\n``` -->\n\n",
    "supporting": [
      "linear-regression_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script type=\"ojs-define\">\n{\"contents\":[{\"name\":\"x\",\"value\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]},{\"name\":\"y\",\"value\":[-0.6814,1.3095,7.6761,4.2115,5.3879,11.1452,8.3827,4.2048,6.9394,8.663,14.6722,13.0794,14.2023,14.332,13.3325,21.3607,18.4936,12.1001,21.1041,18.5816]}]}\n</script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}